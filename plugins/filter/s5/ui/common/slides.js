var allScripts=document.getElementsByTagName("script");var commonPath="ui/common";for(var i=0;i<allScripts.length;i++){if(match=allScripts[i].src.match(/^(.*\/)[^\/]+\/slides.js/)){commonPath=match[1]+"common/"}}var imagePath=commonPath+"images/";var undef;var slideCSS="";var snum=0;var smax=1;var incpos=0;var number=undef;var firstTime=1;var s5mode=true;var helpmode=false;var defaultView="slideshow";var controlVis="visible";var empx=0;var images=new Array();var canvas=new Array();var medias=new Array();var piecharts=new Array();var barcharts=new Array();var linecharts=new Array();var tranSitions=false;var fadeModus=false;var fadeDuration=500;var incrDuration=250;var opac=1;var cid="";var nid="";var tid="";var jl="";var autoMatic=false;var playLoop=false;var playPause=false;var autoRun=false;var playDelay=5000;var remainDer=0;var incrDelay=0;var sound=new Array();var audioSupport=false;var audioVolume=100;var audioError=false;var swfUnloaded=true;var bgSoundItem=9999;var curSoundID=-1;var imgWidth=32;var imgHeight=32;var canvasSupport=false;var ChartData=new Array();var colorSlice=new Array();var font=document.createElement("img");font.setAttribute("src",imagePath+"numeric.png");signs={"0":{sx:0,sy:0,sw:48,sh:64},"1":{sx:48,sy:0,sw:48,sh:64},"2":{sx:96,sy:0,sw:48,sh:64},"3":{sx:144,sy:0,sw:48,sh:64},"4":{sx:192,sy:0,sw:48,sh:64},"5":{sx:240,sy:0,sw:48,sh:64},"6":{sx:288,sy:0,sw:48,sh:64},"7":{sx:336,sy:0,sw:48,sh:64},"8":{sx:384,sy:0,sw:48,sh:64},"9":{sx:432,sy:0,sw:48,sh:64},"%":{sx:480,sy:0,sw:48,sh:64},".":{sx:528,sy:0,sw:24,sh:64}};var colorNames=new Array();colorNames.black="#000000";colorNames.maroon="#800000";colorNames.green="#008000";colorNames.olive="#808000";colorNames.navy="#000080";colorNames.purple="#800080";colorNames.teal="#008080";colorNames.gray="#808080";colorNames.silver="#C0C0C0";colorNames.red="#FF0000";colorNames.lime="#00FF00";colorNames.yellow="#FFFF00";colorNames.blue="#0000FF";colorNames.fuchsia="#FF00FF";colorNames.aqua="#00FFFF";colorNames.white="#FFFFFF";colorNames.aliceblue="#F0F8FF";colorNames.antiquewhite="#FAEBD7";colorNames.aquamarine="#7FFFD4";colorNames.azure="#F0FFFF";colorNames.beige="#F5F5DC";colorNames.blueviolet="#8A2BE2";colorNames.brown="#A52A2A";colorNames.burlywood="#DEB887";colorNames.cadetblue="#5F9EA0";colorNames.chartreuse="#7FFF00";colorNames.chocolate="#D2691E";colorNames.coral="#FF7F50";colorNames.cornflowerblue="#6495ED";colorNames.cornsilk="#FFF8DC";colorNames.crimson="#DC143C";colorNames.darkblue="#00008B";colorNames.darkcyan="#008B8B";colorNames.darkgoldenrod="#B8860B";colorNames.darkgray="#A9A9A9";colorNames.darkgreen="#006400";colorNames.darkkhaki="#BDB76B";colorNames.darkmagenta="#8B008B";colorNames.darkolivegreen="#556B2F";colorNames.darkorange="#FF8C00";colorNames.darkorchid="#9932CC";colorNames.darkred="#8B0000";colorNames.darksalmon="#E9967A";colorNames.darkseagreen="#8FBC8F";colorNames.darkslateblue="#483D8B";colorNames.darkslategray="#2F4F4F";colorNames.darkturquoise="#00CED1";colorNames.darkviolet="#9400D3";colorNames.deeppink="#FF1493";colorNames.deepskyblue="#00BFFF";colorNames.dimgray="#696969";colorNames.dodgerblue="#1E90FF";colorNames.firebrick="#B22222";colorNames.floralwhite="#FFFAF0";colorNames.forestgreen="#228B22";colorNames.gainsboro="#DCDCDC";colorNames.ghostwhite="#F8F8FF";colorNames.gold="#FFD700";colorNames.goldenrod="#DAA520";colorNames.greenyellow="#ADFF2F";colorNames.honeydew="#F0FFF0";colorNames.hotpink="#FF69B4";colorNames.indianred="#CD5C5C";colorNames.indigo="#4B0082";colorNames.ivory="#FFFFF0";colorNames.khaki="#F0E68C";colorNames.lavender="#E6E6FA";colorNames.lavenderblush="#FFF0F5";colorNames.lawngreen="#7CFC00";colorNames.lemonchiffon="#FFFACD";colorNames.lightblue="#ADD8E6";colorNames.lightcoral="#F08080";colorNames.lightcyan="#E0FFFF";colorNames.lightgoldenrodyellow="#FAFAD2";colorNames.lightgreen="#90EE90";colorNames.lightgrey="#D3D3D3";colorNames.lightpink="#FFB6C1";colorNames.lightsalmon="#FFA07A";colorNames.lightseagreen="#20B2AA";colorNames.lightskyblue="#87CEFA";colorNames.lightslategray="#778899";colorNames.lightsteelblue="#B0C4DE";colorNames.lightyellow="#FFFFE0";colorNames.limegreen="#32CD32";colorNames.linen="#FAF0E6";colorNames.mediumaquamarine="#66CDAA";colorNames.mediumblue="#0000CD";colorNames.mediumorchid="#BA55D3";colorNames.ediumpurple="#9370D";colorNames.mediumseagreen="#3CB371";colorNames.mediumslateblue="#7B68EE";colorNames.mediumspringgreen="#00FA9A";colorNames.mediumturquoise="#48D1CC";colorNames.mediumvioletred="#C71585";colorNames.midnightblue="#191970";colorNames.mintcream="#F5FFFA";colorNames.mistyrose="#FFE4E1";colorNames.moccasin="#FFE4B5";colorNames.navajowhite="#FFDEAD";colorNames.oldlace="#FDF5E6";colorNames.olivedrab="#6B8E23";colorNames.orange="#FFA500";colorNames.orangered="#FF4500";colorNames.orchid="#DA70D6";colorNames.palegoldenrod="#EEE8AA";colorNames.palegreen="#98FB98";colorNames.paleturquoise="#AFEEEE";colorNames.palevioletred="#DB7093";colorNames.papayawhip="#FFEFD5";colorNames.peachpuff="#FFDAB9";colorNames.peru="#CD853F";colorNames.pink="#FFC0CB";colorNames.plum="#DDA0DD";colorNames.powderblue="#B0E0E6";colorNames.rosybrown="#BC8F8F";colorNames.royalblue="#4169E1";colorNames.saddlebrown="#8B4513";colorNames.salmon="#FA8072";colorNames.sandybrown="#F4A460";colorNames.seagreen="#2E8B57";colorNames.seashell="#FFF5EE";colorNames.sienna="#A0522D";colorNames.skyblue="#87CEEB";colorNames.slateblue="#6A5ACD";colorNames.slategray="#708090";colorNames.snow="#FFFAFA";colorNames.springgreen="#00FF7F";colorNames.steelblue="#4682B4";colorNames.tan="#D2B48C";colorNames.thistle="#D8BFD8";colorNames.tomato="#FF6347";colorNames.turquoise="#40E0D0";colorNames.violet="#EE82EE";colorNames.wheat="#F5DEB3";colorNames.whitesmoke="#F5F5F5";colorNames.yellowgreen="#9ACD32";var canvas_bgcolor="";var canvas_width=200;var canvas_height=200;var canvas_noshade=0;var canvas_nofill=0;var canvas_noshadow=0;var canvas_htmltext=0;var canvas_imgtext=0;var canvas_notext=0;var s5NotesWindow;var s5NotesWindowLoaded=false;var previousSlide=0;var presentationStart=new Date();var slideStart=new Date();var countdown={timer:0,state:"pause",start:new Date(),end:0,remaining:0};var isIE=navigator.appName=="Microsoft Internet Explorer"&&navigator.userAgent.indexOf("Opera")<1?1:0;if(isIE){var notIE7=parseInt(navigator.appVersion)<7?1:0}var isOp=navigator.userAgent.indexOf("Opera")>-1?1:0;var isGe=navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("Safari")<1?1:0;var isS2=navigator.userAgent.indexOf("Safari")>=2?1:0;function hasClass(a,b){if(!a.className){return false}return(a.className.search("(^|\\s)"+b+"(\\s|$)")!=-1)}function hasValue(a,b){if(!a){return false}return(a.search("(^|\\s)"+b+"(\\s|$)")!=-1)}function removeClass(a,b){if(!a||!hasClass(a,b)){return}a.className=a.className.replace(new RegExp("(^|\\s)"+b+"(\\s|$)"),RegExp.$1+RegExp.$2)}function addClass(a,b){if(!a||hasClass(a,b)){return}if(a.className){a.className+=" "+b}else{a.className=b}}function changeClass(a,b){if(!a){return}a.firstChild.className=b}function GetElementsWithClassName(a,c){var d=document.getElementsByTagName(a);var e=new Array();for(var b=0;b<d.length;b++){if(hasClass(d[b],c)){e[e.length]=d[b]}}return e}function isParentOrSelf(a,b){if(a==null||a.nodeName=="BODY"){return false}else{if(a.id==b){return true}else{return isParentOrSelf(a.parentNode,b)}}}function nodeValue(d){var a="";if(d.nodeType==1){var c=d.childNodes;for(var b=0;b<c.length;++b){a+=nodeValue(c[b])}}else{if(d.nodeType==3){a=d.nodeValue}}return(a)}function slideLabel(){var f=GetElementsWithClassName("*","slide");var g=document.getElementById("jumplist");smax=f.length;for(var c=0;c<smax;c++){var e=f[c];var j="slide"+c.toString();e.setAttribute("id",j);var d="";var b=e.firstChild;if(!b){continue}while(b&&b.nodeType==3){b=b.nextSibling}if(!b){continue}var h=b.childNodes;for(var a=0;a<h.length;a++){d+=nodeValue(h[a])}g.options[g.length]=new Option(c+" : "+d,c)}}function currentSlide(){var d,a,c,b;if(document.getElementById){d=document.getElementById("currentSlide")}else{d=document.currentSlide}c=fadeModus?"F":"&ndash;";b=audioSupport?"S":"&ndash;";a=(autoMatic?(playPause?"||":(playLoop?"&gt;0":"&gt;|")):"&ndash;&ndash;");d.innerHTML='<div id="plink" nowrap="nowrap"><span id="csFade">['+c+b+']</span>&nbsp;<span id="csHere"><strong>'+snum+'</strong></span><span id="csSep">/</span><span id="csTotal">'+(smax-1)+'</span>&nbsp;<span id="csAuto">['+a+"]</span></div>";if(snum==0){d.style.visibility="hidden"}else{d.style.visibility="visible"}}function go(c){if(document.getElementById("slideProj").disabled||c==0){return}jl=document.getElementById("jumplist");cid="slide"+snum;var e=document.getElementById(cid);if(incrementals[snum].length>0){for(var b=0;b<incrementals[snum].length;b++){removeClass(incrementals[snum][b],"current");removeClass(incrementals[snum][b],"incremental")}}if(c!="j"){snum+=c;lmax=smax-1;if(snum>lmax){snum=lmax}if(snum<0){snum=0}}else{snum=parseInt(jl.value)}nid="slide"+snum;var d=document.getElementById(nid);if(!d){d=document.getElementById("slide0");nid="slide0";snum=0}if(c<0){incpos=incrementals[snum].length}else{incpos=0}if(incrementals[snum].length>0&&incpos==0){for(var b=0;b<incrementals[snum].length;b++){if(hasClass(incrementals[snum][b],"current")){incpos=b+1}else{addClass(incrementals[snum][b],"incremental")}}}if(incrementals[snum].length>0&&incpos>0){addClass(incrementals[snum][incpos-1],"current")}var a=document.getElementById("guru");if(a&&snum==0){a.style.visibility="visible"}else{if(a&&snum>0){a.style.visibility="hidden"}}if(tranSitions&&s5mode&&fadeModus){if(curSoundID!=getSoundID(nid)){if(curSoundID==bgSoundItem&&!sound[getSoundID(nid)]){}else{fadeoutSound(curSoundID,true)}}changeOpac(0,nid);changeOpac(100,cid);e.style.visibility="visible";shiftOpacity(cid,fadeDuration);window.setTimeout("changeSlides()",fadeDuration)}else{if(curSoundID!=getSoundID(nid)){if(curSoundID==bgSoundItem&&!sound[getSoundID(nid)]){}else{stopSound(curSoundID)}}e.style.visibility="hidden";if(isOp){location.hash=nid}d.style.visibility="visible";finishSlides()}}function changeSlides(){if(nid!=cid){changeOpac(100,cid)}document.getElementById(cid).style.visibility="hidden";document.getElementById(nid).style.visibility="visible";if(isOp){location.hash=nid}shiftOpacity(nid,fadeDuration);window.setTimeout("finishSlides()",fadeDuration)}function finishSlides(){jl.selectedIndex=snum;currentSlide();loadNote();permaLink();number=undef;if(sound[getSoundID(nid)]){playSound(nid)}else{if(sound[bgSoundItem]&&curSoundID!=bgSoundItem){playSound(bgSoundItem)}}}function goTo(a){if(a>=smax||a==snum){return}go(a-snum)}function subgo(b){if(b>0){removeClass(incrementals[snum][incpos-1],"current");removeClass(incrementals[snum][incpos],"incremental");if(tranSitions&&s5mode&&fadeModus){if(!incrementals[snum][incpos].id){var a=new Date();tid="inc"+String(a.getTime());incrementals[snum][incpos].id=tid}else{tid=incrementals[snum][incpos].id}if(typeof(incrementals[snum][incpos].src)!="undefined"||incrementals[snum][incpos].getContext){changeOpac(0,tid);addClass(incrementals[snum][incpos],"current");shiftOpacity(tid,incrDuration);setTimeout("nextInc()",incrDuration)}else{addClass(incrementals[snum][incpos],"current");nextInc()}}else{addClass(incrementals[snum][incpos],"current");nextInc()}}else{incpos--;removeClass(incrementals[snum][incpos],"current");addClass(incrementals[snum][incpos],"incremental");addClass(incrementals[snum][incpos-1],"current");loadNote()}}function nextInc(){incpos++;loadNote()}function toggle(){var c=GetElementsWithClassName("*","slide");var e=document.getElementById("slideProj");var d=document.getElementById("outlineStyle");var b=document.getElementById("guru");if(!e.disabled){stopPlay();if(audioSupport&&!swfUnloaded){stopAllSounds()}e.disabled=true;d.disabled=false;s5mode=false;fontSize(1,"em");for(var f=0;f<smax;f++){var a=c[f];a.style.visibility="visible"}if(b){b.style.visibility="hidden"}}else{e.disabled=false;d.disabled=true;s5mode=true;fontScale();for(var f=0;f<smax;f++){var a=c[f];a.style.visibility="hidden"}c[snum].style.visibility="visible";if(b&&snum==0){b.style.visibility="visible"}}}function showHide(a){var b=GetElementsWithClassName("*","hideme")[0];switch(a){case"s":b.style.visibility="visible";break;case"h":b.style.visibility="hidden";break;case"k":if(b.style.visibility!="visible"){b.style.visibility="visible"}else{b.style.visibility="hidden"}break}}function keys(a){if(!a){a=event;a.which=a.keyCode}if(helpmode){dumpHelpReq();return}if(a.which==84&&!isOp){toggle();return}if(s5mode){if(autoMatic){switch(a.which){case 70:switchFade();break;case 83:toggleSounds();break;case 67:showHide("k");break;case 65:stopPlay();break;case 76:switchLoop();break;case 80:case 32:pausePlay();break}}else{switch(a.which){case 8:createHelpReq();break;case 10:case 13:if(window.event&&isParentOrSelf(window.event.srcElement,"controls")){return}if(a.target&&isParentOrSelf(a.target,"controls")){return}if(number!=undef){goTo(number);break}case 32:case 34:case 39:case 40:if(number!=undef){go(number)}else{if(!incrementals[snum]||incpos>=incrementals[snum].length){go(1)}else{subgo(1)}}break;case 33:case 37:case 38:if(number!=undef){go(-1*number)}else{if(!incrementals[snum]||incpos<=0){go(-1)}else{subgo(-1)}}break;case 65:startPlay();break;case 72:case 36:goTo(0);break;case 69:case 35:goTo(smax-1);break;case 70:switchFade();break;case 76:switchLoop();break;case 83:toggleSounds();break;case 27:case 81:if(!isOp){byby()}break;case 67:showHide("k");break;case 78:createNotesWindow();break}if(a.which<48||a.which>57){number=undef}else{if(window.event&&isParentOrSelf(window.event.srcElement,"controls")){return}if(a.target&&isParentOrSelf(a.target,"controls")){return}number=(((number!=undef)?number:0)*10)+(a.which-48)}}}return false}function clicker(b){number=undef;var a;if(window.event){a=window.event.srcElement;b=window.event}else{a=b.target}if(a.href!=null||hasValue(a.rel,"external")||isParentOrSelf(a,"controls")||isParentOrSelf(a,"embed")||isParentOrSelf(a,"object")){return true}if(!helpmode){if(!b.which||b.which==1){if(!incrementals[snum]||incpos>=incrementals[snum].length){go(1)}else{subgo(1)}}}else{dumpHelpReq()}}function findSlide(d){var c=null;var b=GetElementsWithClassName("*","slide");for(var a=0;a<b.length;a++){var e=b[a];if((e.name&&e.name==d)||(e.id&&e.id==d)){c=e;break}}while(c!=null&&c.nodeName!="BODY"){if(hasClass(c,"slide")){return parseInt(c.id.slice(5))}c=c.parentNode}return null}function slideJump(){if(window.location.hash==null){return}var b=/^#slide(\d+)$/;var c=b.exec(window.location.hash);var a=null;if(c!=null){a=parseInt(c[1])}else{a=findSlide(window.location.hash.slice(1))}if(a!=null){go(a-snum)}}function fixLinks(){var f=window.location.href;f=f.slice(0,f.length-window.location.hash.length);var g=document.getElementsByTagName("A");for(var e=0;e<g.length;e++){var b=g[e].href;var d=b.match("#slide[0-9]{1,2}");if((d)&&(d[0].slice(0,1)=="#")){var c=findSlide(d[0].slice(1));if(c!=null){if(g[e].addEventListener){g[e].addEventListener("click",new Function("e","if (document.getElementById('slideProj').disabled) return;go("+c+" - snum); if (e.preventDefault) e.preventDefault();"),true)}else{if(g[e].attachEvent){g[e].attachEvent("onclick",new Function("","if (document.getElementById('slideProj').disabled) return;go("+c+" - snum); event.returnValue = false;"))}}}}}}function externalLinks(){if(!document.getElementsByTagName){return}var c=document.getElementsByTagName("a");for(var b=0;b<c.length;b++){var a=c[b];if(a.getAttribute("href")&&hasValue(a.rel,"external")){a.target="_blank";addClass(a,"external")}}}function permaLink(){document.getElementById("plink").href=window.location.pathname+"#slide"+snum}function createControls(){var g=document.getElementById("controls");if(!g){return}var d=" onmouseover=\"showHide('s');\" onmouseout=\"showHide('h');\"";var f,a="";if(controlVis=="hidden"){f=d}else{a=d}if(isOp){var e=""}else{var e='<a accesskey="t" id="sheet" title="toggle CSS" href="javascript:toggle();">&plusmn;</a>'}if(isIE){var b="move around&xA0;until the color&xA0;change to red!"}else{if(isS2){var b="move around\r\nuntil the color\r\nchange to red!"}else{var b="move around until color change to red!"}}if(isIE){g.innerHTML=e+'<form action="#" id="controlForm"'+f+'><div id="navLinks" title="press [backspace] for keyboard help!"><ul><li id="show-notes"><a href="javascript:createNotesWindow();" accesskey="n" title="show Notes"></a></li><li id="toggle"><a href="javascript:toggle();" accesskey="t" title="toggle CSS"></a></li><li id="zero"><a href="javascript:goTo(0);" accesskey="h" title="goto Start Slide"></a></li><li id="prev"><a href="javascript:go(-1);" accesskey="y" title="previous Slide"></a></li><li id="next"><a href="javascript:go(1);" accesskey="x" title="next Slide"></a></li><li id="last"><a href="javascript:goTo(smax-1);" accesskey="e" title="goto Last Slide"></a></li><li id="lst" style="vertical-align: middle; width: 160px;"><select style="cursor: auto; width: 160px; height: auto;" id="jumplist" title="select named Slide" onchange="go(\'j\');"></select></li><li id="auto"><a class="isoff" href="javascript:togglePlay();" accesskey="a" title="Auto Play"></a></li><li id="pause"><a class="isoff" href="javascript:pausePlay();" accesskey="p" title="Pause"></a></li><li id="loop"><a class="isoff" href="javascript:switchLoop();" accesskey="l" title="Loop"></a></li><li id="del" style="vertical-align: middle; width: 52px;"><select style="cursor: auto; width: 52px; height: auto;" id="delaylist" title="select Delay" onchange="setDelay();"><option value="90">90</option><option value="75">75</option><option value="60">60</option><option value="45">45</option><option value="30">30</option><option value="20">20</option><option value="15">15</option><option value="10">10</option><option value="5">5</option></select></li></ul></div></form>'}else{g.innerHTML=e+'<form action="#" id="controlForm"'+f+'><div id="navLinks" title="press [backspace] or double click this area for keyboard help!" ondblclick="createHelpReq();"><ul><li id="exit"><a href="javascript:byby();" accesskey="q" title="exit Show"></a></li><li id="show-notes"><a href="javascript:createNotesWindow();" accesskey="n" title="show Notes"></a></li><li id="toggle"><a href="javascript:toggle();" accesskey="t" title="toggle CSS"></a></li><li class="vr"></li><li id="zero"><a href="javascript:goTo(0);" accesskey="h" title="goto Start Slide"></a></li><li id="prev"><a href="javascript:go(-1);" accesskey="y" title="previous Slide"></a></li><li id="next"><a href="javascript:go(1);" accesskey="x" title="next Slide"></a></li><li id="last"><a href="javascript:goTo(smax-1);" accesskey="e" title="goto Last Slide"></a></li><li id="lst"><a id="list" style="cursor:wait;" title="'+b+'"></a><select id="jumplist" title="select named Slide" onchange="go(\'j\');"></select></li><li id="fadeLinks" class="vr"></li><li id="fade"><a class="isoff" href="javascript:switchFade();" accesskey="f" title="Transions"></a></li><li id="audioLinks" class="vr"></li><li id="audio"><a class="isoff" href="javascript:toggleSounds();" accesskey="s" title="Sounds" ></a></li><li id="vol"><a id="volume" style="cursor:wait;" title="'+b+'"></a><select id="volumelist" title="select Volume" onchange="setVolume();"><option value="100">100</option><option value="90">90</option><option value="80">80</option><option value="70">70</option><option value="60">60</option><option value="50">50</option><option value="40">40</option><option value="30">30</option><option value="20">20</option><option value="10">10</option><option value="0">0</option></select></li><li id="autoLinks" class="vr"></li><li id="auto"><a class="isoff" href="javascript:togglePlay();" accesskey="a" title="Auto Play"></a></li><li id="pause"><a class="isoff" href="javascript:pausePlay();" accesskey="p" title="Pause"></a></li><li id="loop"><a class="isoff" href="javascript:switchLoop();" accesskey="l" title="Loop"></a></li><li id="del"><a id="delay" style="cursor:wait;" title="'+b+'"></a><select id="delaylist" title="select Delay" onchange="setDelay();"><option value="90">90</option><option value="75">75</option><option value="60">60</option><option value="45">45</option><option value="30">30</option><option value="20">20</option><option value="15">15</option><option value="10">10</option><option value="5">5</option></select></li></ul></div></form>'}if(controlVis=="hidden"){var c=document.getElementById("navLinks")}else{var c=document.getElementById("jumplist")}addClass(c,"hideme")}function fontScale(){if(!s5mode&&!isOp){return false}var h=screen.width;var a=screen.height;var j=window.outerHeight;var e=window.outerWidth;if(isOp&&s5mode&&defaultView=="slideshow"&&((h!=e)||(a!=j))){toggle();return false}if(isOp&&!s5mode&&((h!=e)||(a!=j))){return false}if(isOp&&!s5mode&&(h==e)&&(a==j)){toggle()}var c=48;var k=64;if(window.innerHeight){var b=window.innerHeight;var d=window.innerWidth}else{if(document.documentElement.clientHeight){var b=document.documentElement.clientHeight;var d=document.documentElement.clientWidth}else{if(document.body.clientHeight){var b=document.body.clientHeight;var d=document.body.clientWidth}else{var b=700;var d=1024}}}var g=Math.min(Math.round(b/c),Math.round(d/k));extendImgSizes(g);extendCanSizes(g);extendObjSizes(g);fontSize(g,"px");if(!isS2||firstTime==0){generateCanvas()}if(isGe){var f=document.getElementsByTagName("body")[0];f.style.visibility="hidden";f.style.display="none";f.style.display="block";f.style.visibility="visible";changeOpac(100,"slide"+snum);shiftOpacity("slide"+snum,10);window.setTimeout("fixReflow()",10)}else{setListPos()}}function fixReflow(){shiftOpacity("slide"+snum,10);window.setTimeout("finishReflow()",10)}function finishReflow(){setListPos()}function fontSize(c,a){var b=c+a;if(!(s5ss=document.getElementById("s5ss"))){if(!document.createStyleSheet){document.getElementsByTagName("head")[0].appendChild(s5ss=document.createElement("style"));s5ss.setAttribute("media","screen, projection");s5ss.setAttribute("id","s5ss")}else{document.createStyleSheet();document.s5ss=document.styleSheets[document.styleSheets.length-1]}}if(!(document.s5ss&&document.s5ss.addRule)){while(s5ss.lastChild){s5ss.removeChild(s5ss.lastChild)}s5ss.appendChild(document.createTextNode("html {font-size: "+b+" !important;}"))}else{document.s5ss.addRule("html","font-size: "+b+" !important;")}}function windowChange(){fontScale()}function notOperaFix(){slideCSS=document.getElementById("slideProj").href;var b=document.getElementById("slideProj");var a=document.getElementById("outlineStyle");b.setAttribute("media","screen");a.disabled=true;if(isGe){b.setAttribute("href","null");b.setAttribute("href",slideCSS)}if((isIE&&notIE7)&&document.styleSheets&&document.styleSheets[0]){document.styleSheets[0].addRule("img","behavior: url("+imagePath+"iepngfix.htc)");document.styleSheets[0].addRule("div","behavior: url("+imagePath+"iepngfix.htc)");document.styleSheets[0].addRule(".slide","behavior: url("+imagePath+"iepngfix.htc)")}}function getIncrementals(e){var d=new Array();if(!e){return d}var c=e.childNodes;for(var b=0;b<c.length;b++){var f=c[b];if(hasClass(f,"incremental")){if(f.nodeName=="OL"||f.nodeName=="UL"){removeClass(f,"incremental");for(var a=0;a<f.childNodes.length;a++){if(f.childNodes[a].nodeType==1){addClass(f.childNodes[a],"incremental")}}}else{d[d.length]=f;removeClass(f,"incremental")}}if(hasClass(f,"show-first")){if(f.nodeName=="OL"||f.nodeName=="UL"){removeClass(f,"show-first");if(f.childNodes[isGe].nodeType==1){removeClass(f.childNodes[isGe],"incremental")}}else{d[d.length]=f}}d=d.concat(getIncrementals(f))}return d}function createIncrementals(){var b=new Array();for(var a=0;a<smax;a++){b[a]=getIncrementals(document.getElementById("slide"+a))}return b}function trap(a){if(!a){a=event;a.which=a.keyCode}try{modifierKey=a.ctrlKey||a.altKey||a.metaKey}catch(a){modifierKey=false}return modifierKey||a.which==0}function noteLabel(){var b=GetElementsWithClassName("div","notes");for(var a=0;a<b.length;a++){var c=b[a];var d="note"+c.parentNode.id.substring(5);c.setAttribute("id",d)}resetElapsedSlide();resetRemainingTime();window.setInterval("updateElaspedTime()",1000)}function createNotesWindow(){if(!s5NotesWindow||s5NotesWindow.closed){s5NotesWindowLoaded=false;s5NotesWindow=window.open(commonPath+"notes.html","s5NotesWindow","top=0,left=0")}if(s5NotesWindowLoaded){loadNote()}else{window.setTimeout("createNotesWindow()",50)}}function loadNote(){var c=nextNotes='<em class="disclaimer">There are no notes for this slide.</em>';if(document.getElementById("note"+snum)){c=document.getElementById("note"+snum).innerHTML}if(document.getElementById("note"+(snum+1))){nextNotes=document.getElementById("note"+(snum+1)).innerHTML}var b=document.getElementById("jumplist");var a=b.options[b.selectedIndex].text.replace(/^\d+\s+:\s+/,"")+((b.selectedIndex)?" ("+b.selectedIndex+"/"+(smax-1)+")":"");if(incrementals[snum].length>0){a+=" <small>["+incpos+"/"+incrementals[snum].length+"]</small>"}if(b.selectedIndex<smax-1){var d=b.options[b.selectedIndex+1].text.replace(/^\d+\s+:\s+/,"")+((b.selectedIndex+1)?" ("+(b.selectedIndex+1)+"/"+(smax-1)+")":"")}else{var d="[end of slide show]"}if(s5NotesWindow&&!s5NotesWindow.closed&&s5NotesWindow.document){s5NotesWindow.document.getElementById("slide").innerHTML=a;s5NotesWindow.document.getElementById("notes").innerHTML=c;s5NotesWindow.document.getElementById("next").innerHTML=d;s5NotesWindow.document.getElementById("nextnotes").innerHTML=nextNotes}resetElapsedSlide()}function minimizeTimer(b){var a=s5NotesWindow.document.getElementById(b);if(hasClass(a,"collapsed")){removeClass(a,"collapsed")}else{addClass(a,"collapsed")}}function resetElapsedTime(){presentationStart=new Date();slideStart=new Date();updateElaspedTime()}function resetElapsedSlide(){if(snum!=previousSlide){slideStart=new Date();previousSlide=snum;updateElaspedTime()}}function updateElaspedTime(){if(!s5NotesWindowLoaded||!s5NotesWindow||s5NotesWindow.closed){return}var b=new Date();var a=s5NotesWindow.document.getElementById("elapsed-presentation");var c=s5NotesWindow.document.getElementById("elapsed-slide");a.innerHTML=formatTime(b.valueOf()-presentationStart.valueOf());c.innerHTML=formatTime(b.valueOf()-slideStart.valueOf())}function resetRemainingTime(){if(!s5NotesWindowLoaded||!s5NotesWindow||s5NotesWindow.closed){return}var b=s5NotesWindow.document.getElementById("startFrom");startFrom=readTime(b.value);countdown.remaining=startFrom*60000;countdown.start=new Date().valueOf();countdown.end=countdown.start+countdown.remaining;var a=s5NotesWindow.document.getElementById("timeLeft");var c=formatTime(countdown.remaining);a.innerHTML=c}function updateRemainingTime(){if(!s5NotesWindowLoaded||!s5NotesWindow||s5NotesWindow.closed){return}var a=s5NotesWindow.document.getElementById("timeLeft");var b=new Date();if(countdown.state=="run"){countdown.remaining=countdown.end-b}a.style.color="";a.style.backgroundColor="";if(countdown.remaining>=0){var c=formatTime(countdown.remaining);removeClass(a,"overtime");if(countdown.remaining<300000){a.style.color="rgb("+(255-Math.round(countdown.remaining/2000))+",0,0)";a.style.backgroundColor="rgb(255,255,"+(Math.round(countdown.remaining/2000))+")"}}else{var c="-"+formatTime(-countdown.remaining);addClass(a,"overtime")}a.innerHTML=c}function toggleRemainingTime(){if(countdown.state=="pause"){countdown.state="run"}else{countdown.state="pause"}if(countdown.state=="pause"){window.clearInterval(countdown.timer)}if(countdown.state=="run"){countdown.start=new Date().valueOf();countdown.end=countdown.start+countdown.remaining;countdown.timer=window.setInterval("updateRemainingTime()",1000)}}function alterRemainingTime(b){var a=b*60000;countdown.end+=a;countdown.remaining+=a;updateRemainingTime()}function formatTime(e){var d=new Date(e);var b=d.getUTCHours()+((d.getUTCDate()-1)*24);b=(b<10)?"0"+b:b;if(b=="NaN"||isNaN(b)){b="--"}var a=d.getUTCMinutes();a=(a<10)?"0"+a:a;if(a=="NaN"||isNaN(a)){a="--"}var c=d.getUTCSeconds();c=(c<10)?"0"+c:c;if(c=="NaN"||isNaN(c)){c="--"}return b+":"+a+":"+c}function readTime(g){var b=/:/;var e=b.exec(g);if(e==null){return g}else{var f=g.split(":");var a=parseInt(f[0]);var d=parseInt(f[1]);var c=(a*60)+d;return c}}function createSlideShow(){defaultCheck();if(!isIE){createDetector()}if(opac!=0||isIE){tranSitions=false;fadeModus=false}if(tranSitions&&document.getElementById&&document.createElement){createProgress();var a=document.getElementById("StartupControl");a.onload=dumpProgress}else{startup();showAll();setListPos(true);panelSetup();audioSetup();if(isS2&&firstTime>=1){generateCanvas()}firstTime=0}}function defaultCheck(){var a=document.getElementsByTagName("meta");for(var c=0;c<a.length;c++){if(a[c].name=="defaultView"){defaultView=a[c].content}if(a[c].name=="controlVis"){controlVis=a[c].content}if(a[c].name=="tranSitions"){tranSitions=(a[c].content=="true")?true:false;fadeModus=(tranSitions==true)?true:false}if(a[c].name=="fadeDuration"){var b=parseInt(a[c].content);fadeDuration=Math.max(200,Math.min(b,2000))}if(a[c].name=="incrDuration"){var b=parseInt(a[c].content);incrDuration=Math.max(50,Math.min(b,500))}if(a[c].name=="autoMatic"){autoMatic=(a[c].content=="true")?true:false}if(a[c].name=="playLoop"){playLoop=(a[c].content=="true")?true:false}if(a[c].name=="playDelay"){var b=parseInt(a[c].content);playDelay=Math.max(5,Math.min(b,90))*1000;playDelay=(fadeModus==true)?(playDelay+(2*fadeDuration)):playDelay}if(a[c].name=="audioSupport"){audioSupport=(a[c].content=="true")?true:false}if(a[c].name=="audioVolume"){var b=parseInt(a[c].content);audioVolume=Math.max(0,Math.min(b,100))}if(a[c].name=="audioError"){audioError=(a[c].content=="true")?true:false}}}function createProgress(){var b=document.getElementsByTagName("body")[0].firstChild;var c=document.createElement("div");c.id="StartupProgress";c.style.position="absolute";c.style.left=0+"px";c.style.top=0+"px";c.style.width=100+"%";c.style.height=100+"%";c.style.margin=0+"px";c.style.padding=0+"px";if(isIE){c.style.filter="alpha(opacity=100)"}else{c.style.opacity=1}c.style.zIndex=9999;c.style.backgroundColor="rgb(255, 255, 255)";c.style.textAlign="center";c.style.verticalAlign="middle";c.style.backgroundPosition="center center";c.style.backgroundRepeat="no-repeat";c.style.backgroundImage="url("+imagePath+"progress.gif)";document.getElementsByTagName("body")[0].insertBefore(c,b);var a=document.createElement("img");a.id="StartupControl";a.src=imagePath+"blank.gif?"+new Date().valueOf();document.getElementsByTagName("body")[0].appendChild(a)}function startup(){createControls();slideLabel();incrementals=createIncrementals();noteLabel();loadNote();fixLinks();externalLinks();fontScale();if(!isOp){if(isIE){document.getElementById("lst").style.backgroundImage="none";document.getElementById("del").style.backgroundImage="none"}else{document.getElementById("audio").style.backgroundImage="none"}notOperaFix()}else{if(isOp){var a=document.getElementById("exit");a.firstChild.style.visibility="hidden";document.getElementById("exit").style.opacity=0.5;a=document.getElementById("toggle");a.firstChild.style.visibility="hidden";document.getElementById("toggle").style.opacity=0.5;document.getElementById("jumplist").style.visibility="hidden";document.getElementById("list").style.visibility="hidden";document.getElementById("lst").style.opacity=0.5;a=document.getElementById("audio");a.firstChild.style.visibility="hidden";document.getElementById("audio").style.opacity=0.5;document.getElementById("volumelist").style.visibility="hidden";document.getElementById("volume").style.visibility="hidden";document.getElementById("vol").style.opacity=0.5;document.getElementById("delaylist").style.visibility="hidden";document.getElementById("delay").style.visibility="hidden";document.getElementById("del").style.opacity=0.5}}slideJump();if(defaultView=="outline"){toggle()}document.onkeyup=keys;document.onkeypress=trap;document.onclick=clicker}function preloadImgages(){var a="";var c=document.getElementsByTagName("img");for(var b=0;b<c.length;b++){if(c[b].src!=""){a=new Image();a.src=c[b].src}}}function showAll(){var b=GetElementsWithClassName("div","presentation")[0];if(!b){var b=GetElementsWithClassName("ol","presentation")[0]}var a=GetElementsWithClassName("div","layout")[0];if(b){b.style.display="block"}if(a){a.style.display="block"}}function dumpProgress(){document.body.removeChild(document.getElementById("StartupControl"));startup();preloadImgages();showAll();createSoundManagerScript();shiftOpacity("StartupProgress",1000);window.setTimeout("removeProgress()",1000)}function removeProgress(){document.body.removeChild(document.getElementById("StartupProgress"));setListPos(true);panelSetup();audioSetup();if(isS2&&firstTime>=1){generateCanvas()}firstTime=0}function panelSetup(){if(playPause){var c=document.getElementById("pause");changeClass(c,"ison")}if(playLoop){var c=document.getElementById("loop");changeClass(c,"ison")}if(audioSupport&&!isIE&&!isOp){var c=document.getElementById("audio");changeClass(c,"ison")}if(fadeModus&&!isIE){var c=document.getElementById("fade");changeClass(c,"ison")}if(autoMatic){var c=document.getElementById("auto");changeClass(c,"ison");startPlay()}if(audioVolume&&!isIE&&!isOp){var a=0;if(audioVolume>=95&&audioVolume<=100){a=0}else{if(audioVolume>=85&&audioVolume<95){a=1}else{if(audioVolume>=75&&audioVolume<85){a=2}else{if(audioVolume>=65&&audioVolume<75){a=3}else{if(audioVolume>=55&&audioVolume<65){a=4}else{if(audioVolume>=45&&audioVolume<55){a=5}else{if(audioVolume>=35&&audioVolume<45){a=6}else{if(audioVolume>=25&&audioVolume<35){a=7}else{if(audioVolume>=15&&audioVolume<25){a=8}else{if(audioVolume>=5&&audioVolume<15){a=9}else{a=10}}}}}}}}}}document.getElementById("volumelist").selectedIndex=a}if(playDelay&&!isOp){var a=0;var b=parseInt(playDelay/1000);if(b>=83&&b<=90){a=0}else{if(b>=68&&b<83){a=1}else{if(b>=53&&b<68){a=2}else{if(b>=38&&b<53){a=3}else{if(b>=25&&b<38){a=4}else{if(b>=18&&b<25){a=5}else{if(b>=13&&b<18){a=6}else{if(b>=8&&b<13){a=7}else{a=8}}}}}}}}document.getElementById("delaylist").selectedIndex=a}}function byby(){stopPlay();if(tranSitions&&fadeModus&&s5mode&&!isOp){fadeoutSound(curSoundID,true);var a=document.createElement("div");a.id="GoodBy";a.style.position="absolute";a.style.left=0+"px";a.style.top=0+"px";a.style.width=100+"%";a.style.height=100+"%";a.style.margin=0+"px";a.style.padding=0+"px";if(isIE){a.style.filter="alpha(opacity=0)"}else{a.style.opacity=0}a.style.zIndex=9999;a.style.backgroundColor="rgb(255, 255, 255)";a.style.textAlign="center";a.style.verticalAlign="middle";a.style.backgroundPosition="center center";a.style.backgroundRepeat="no-repeat";a.style.backgroundImage="url("+imagePath+"finish.gif)";document.getElementsByTagName("body")[0].appendChild(a);shiftOpacity("GoodBy",1000);window.setTimeout("history.back()",1000)}else{stopSound(curSoundID);history.back()}}function createDetector(){var a=document.createElement("div");a.id="EMSizeControl";a.style.position="absolute";a.style.left="-999px";a.style.width="1em";a.style.height="1em";a.style.opacity=0;document.getElementsByTagName("body")[0].appendChild(a);var g=document.getElementById("EMSizeControl");if(g&&findPosX(g)==-999){opac=document.getElementById("EMSizeControl").style.opacity;empx=document.getElementById("EMSizeControl").offsetHeight;document.body.removeChild(document.getElementById("EMSizeControl"));var r=document.getElementsByTagName("img");var e=0;var n=0;var c=0;var p;var m;for(n=0;n<r.length;n++){if(r[n].className.match(/^scale/i)){images[e]=r[n];++e}}var r=document.getElementsByTagName("canvas");e=0;for(n=0;n<r.length;n++){if(r[n].className.match(/^scale/i)){canvas[r[n].id]=r[n];if(e==0){if(r[n].getContext){canvasSupport=true}++e}}}if(canvasSupport!=true){for(p in canvas){canvas[p].setAttribute("width",1);canvas[p].setAttribute("height",1)}}var r=document.getElementsByTagName("table");e=0;c=0;l=0;var q;var o;var f;var b;for(n=0;n<r.length;n++){if(r[n].className.match(/^piechart/i)){f=r[n].id;b=f.split("_");m=b[0]+"_canvas";if(canvas[m]){q=canvas[m].getAttribute("width");o=canvas[m].getAttribute("height");if(q>0&&o>0){piecharts[e]=r[n];a=piecharts[e].getAttribute("summary");if(a!=""){a=","+a}piecharts[e].setAttribute("summary",q+","+o+a);++e}}}if(r[n].className.match(/^barchart/i)){f=r[n].id;b=f.split("_");m=b[0]+"_canvas";if(canvas[m]){q=canvas[m].getAttribute("width");o=canvas[m].getAttribute("height");if(q>0&&o>0){barcharts[c]=r[n];a=barcharts[c].getAttribute("summary");if(a!=""){a=","+a}barcharts[c].setAttribute("summary",q+","+o+a);++c}}}if(r[n].className.match(/^linechart/i)){f=r[n].id;b=f.split("_");m=b[0]+"_canvas";if(canvas[m]){q=canvas[m].getAttribute("width");o=canvas[m].getAttribute("height");if(q>0&&o>0){linecharts[l]=r[n];a=linecharts[l].getAttribute("summary");if(a!=""){a=","+a}linecharts[l].setAttribute("summary",q+","+o+a);++l}}}}r=document.getElementsByTagName("object");e=0;n=0;for(n=0;n<r.length;n++){if(r[n].className.match(/^scale/i)){medias[e]=r[n];++e;if(!isIE){if(r[n].getAttributeNode("classid")){r[n].removeAttributeNode(r[n].getAttributeNode("classid"))}if(r[n].getAttributeNode("codebase")){r[n].removeAttributeNode(r[n].getAttributeNode("codebase"))}}}}}}function extendImgSizes(e){if(empx>0){var d=(e/empx);var a=0;var c=0;for(var b=0;b<images.length;b++){a=images[b].getAttribute("width",0);c=images[b].getAttribute("height",0);if(a>0&&c>0){images[b].style.width=Math.floor(a*d)+"px";images[b].style.height=Math.floor(c*d)+"px"}}}}function extendCanSizes(j){if(empx>0&&canvasSupport){var g=(j/empx);var a=0;var e=0;var d="";var c;var k;for(var b=0;b<piecharts.length;b++){if(piecharts[b].getAttribute("summary")){d=piecharts[b].getAttribute("summary");c=d.split(",");if(c[0].match(/^[1-9][0-9]+/)){a=parseInt(c[0])}if(c[1].match(/^[1-9][0-9]+/)){e=parseInt(c[1])}if(a>0&&e>0){d=piecharts[b].id;c=d.split("_");k=c[0]+"_canvas";canvas[k].setAttribute("width",Math.floor(a*g));canvas[k].setAttribute("height",Math.floor(e*g));canvas[k].style.width=Math.floor(a*g)+"px";canvas[k].style.height=Math.floor(e*g)+"px"}}}for(var b=0;b<barcharts.length;b++){if(barcharts[b].getAttribute("summary")){d=barcharts[b].getAttribute("summary");c=d.split(",");if(c[0].match(/^[1-9][0-9]+/)){a=parseInt(c[0])}if(c[1].match(/^[1-9][0-9]+/)){e=parseInt(c[1])}if(a>0&&e>0){d=barcharts[b].id;c=d.split("_");k=c[0]+"_canvas";canvas[k].setAttribute("width",Math.floor(a*g));canvas[k].setAttribute("height",Math.floor(e*g));canvas[k].style.width=Math.floor(a*g)+"px";canvas[k].style.height=Math.floor(e*g)+"px"}}}for(var b=0;b<linecharts.length;b++){if(linecharts[b].getAttribute("summary")){d=linecharts[b].getAttribute("summary");c=d.split(",");if(c[0].match(/^[1-9][0-9]+/)){a=parseInt(c[0])}if(c[1].match(/^[1-9][0-9]+/)){e=parseInt(c[1])}if(a>0&&e>0){d=linecharts[b].id;c=d.split("_");k=c[0]+"_canvas";canvas[k].setAttribute("width",Math.floor(a*g));canvas[k].setAttribute("height",Math.floor(e*g));canvas[k].style.width=Math.floor(a*g)+"px";canvas[k].style.height=Math.floor(e*g)+"px"}}}}}function extendObjSizes(e){if(empx>0){var d=(e/empx);var a=0;var c=0;for(var b=0;b<medias.length;b++){a=medias[b].getAttribute("width",0);c=medias[b].getAttribute("height",0);if(a>0&&c>0){medias[b].style.width=Math.floor(a*d)+"px";medias[b].style.height=Math.floor(c*d)+"px"}}}}function findPosX(b){var a=0;while(b.offsetParent){a+=b.offsetLeft;b=b.offsetParent}return a}function findPosY(b){var a=0;while(b.offsetParent){a+=b.offsetTop;b=b.offsetParent}return a}function deg2rad(a){return Math.PI*a/180}function rad2deg(a){return 180*a/Math.PI}function circle_point_x(c,b){var a=Math.cos(c)*(b/2);return a}function circle_point_y(b,a){var c=Math.sin(b)*(a/2);return c}function roundTo(c,b){var a=c;if(c>8191&&c<10485){c=c-5000;a=Math.round(c*Math.pow(10,b))/Math.pow(10,b);a=a+5000}else{a=Math.round(c*Math.pow(10,b))/Math.pow(10,b)}return a}function searchColor(b){for(var a in colorNames){if(a==b){return colorNames[a]}}return false}function scanColor(e){if(e.match(/^#[0-9a-f][0-9a-f][0-9a-f]$/i)){var d=e.substr(1,1).toLowerCase();var c=e.substr(2,1).toLowerCase();var b=e.substr(3,1).toLowerCase();e="#"+d+d+c+c+b+b}if(!e.match(/^#[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]$/i)){var a=searchColor(e.toLowerCase());if(a){e=a}}if(!e.match(/^#[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]$/i)){e="#000000"}return e.toLowerCase()}function hex2rgb(e,a){if(e.length==7){var d=Math.max(0,Math.min(parseInt(e.substr(1,2),16),255));var c=Math.max(0,Math.min(parseInt(e.substr(3,2),16),255));var b=Math.max(0,Math.min(parseInt(e.substr(5,2),16),255));return"rgba("+d+","+c+","+b+","+a+")"}}function trim(a){return(a.replace(/\s+$/,"").replace(/^\s+/,""))}function roundedRect(d,c,f,e,b,a){d.beginPath();d.moveTo(c,f+a);d.lineTo(c,f+b-a);d.quadraticCurveTo(c,f+b,c+a,f+b);d.lineTo(c+e-a,f+b);d.quadraticCurveTo(c+e,f+b,c+e,f+b-a);d.lineTo(c+e,f+a);d.quadraticCurveTo(c+e,f,c+e-a,f);d.lineTo(c+a,f);d.quadraticCurveTo(c,f,c,f+a);d.closePath()}function drawString(d,h,f,b,a){var g=0;var j="";d.beginPath();for(var e=0;e<h.length;e++){j=h[e];d.drawImage(font,signs[j].sx,signs[j].sy,signs[j].sw,signs[j].sh,b+g,a,signs[j].sw*f,signs[j].sh*f);g+=(signs[j].sw*f)}d.closePath()}function strokeString(m,j,a,n,h,e){var c=n*0.666666;var b=n*0.125;var g=b/2;var k=b;var d=0;m.lineCap="round";m.lineJoin="round";m.lineWidth=b;m.strokeStyle=a;for(var f=0;f<j.length;f++){strokeSymbol(m,j[f],g,h+d,e,c,n);d+=(j[f]!="."?c+k:(c/2)+k)}}function strokeSymbol(c,f,e,a,g,b,d){c.beginPath();switch(f){case"0":c.moveTo(a+e,g+(d*0.333333));c.arc(a+(b/2),g+(b/2),(b/2)-e,deg2rad(180),0,false);c.arc(a+(b/2),(g+d)-(b/2),(b/2)-e,0,deg2rad(180),false);c.closePath();break;case"1":c.moveTo(a+(b*0.1)+e,g+d-e);c.lineTo(a+b-e,g+d-e);c.moveTo(a+(b*0.666666),g+d-e);c.lineTo(a+(b*0.666666),g+e);c.lineTo(a+(b*0.25),g+(d*0.25));break;case"2":c.moveTo(a+b-e,g+(d*0.8));c.lineTo(a+b-e,g+d-e);c.lineTo(a+e,g+d-e);c.arc(a+(b/2),g+(b*0.425),(b*0.425)-e,deg2rad(45),deg2rad(-180),true);break;case"3":c.moveTo(a+(b*0.1)+e,g+e);c.lineTo(a+(b*0.9)-e,g+e);c.arc(a+(b/2),g+d-(b*0.5),(b*0.5)-e,deg2rad(-90),deg2rad(180),false);break;case"4":c.moveTo(a+(b*0.75),g+d-e);c.lineTo(a+(b*0.75),g+e);c.moveTo(a+b-e,g+(d*0.666666));c.lineTo(a+e,g+(d*0.666666));c.lineTo(a+(b*0.75),g+e);c.moveTo(a+b-e,g+d-e);c.lineTo(a+(b*0.5),g+d-e);break;case"5":c.moveTo(a+(b*0.9)-e,g+e);c.lineTo(a+(b*0.1)+e,g+e);c.lineTo(a+(b*0.1)+e,g+(d*0.333333));c.arc(a+(b/2),g+d-(b*0.5),(b*0.5)-e,deg2rad(-80),deg2rad(180),false);break;case"6":c.moveTo(a+e,g+d-(b*0.5)-e);c.arc(a+(b/2),g+d-(b*0.5),(b*0.5)-e,deg2rad(-180),deg2rad(180),false);c.bezierCurveTo(a+e,g+e,a+e,g+e,a+(b*0.9)-e,g+e);c.moveTo(a+(b*0.9)-e,g+e);break;case"7":c.moveTo(a+(b*0.5),g+d-e);c.lineTo(a+b-e,g+e);c.lineTo(a+(b*0.1)+e,g+e);c.lineTo(a+(b*0.1)+e,g+(d*0.25)-e);break;case"8":c.moveTo(a+(b*0.92)-e,g+(b*0.59));c.arc(a+(b/2),g+(b*0.45),(b*0.45)-e,deg2rad(25),deg2rad(-205),true);c.arc(a+(b/2),g+d-(b*0.5),(b*0.5)-e,deg2rad(-135),deg2rad(-45),true);c.closePath();c.moveTo(a+(b*0.79),g+(d*0.47));c.lineTo(a+(b*0.21),g+(d*0.47));break;case"9":c.moveTo(a+b-e,g+(b*0.5));c.arc(a+(b/2),g+(b*0.5),(b*0.5)-e,deg2rad(0),deg2rad(360),false);c.bezierCurveTo(a+b-e,g+d-e,a+b-e,g+d-e,a+(b*0.1)+e,g+d-e);break;case"%":c.moveTo(a+e,g+(d*0.75));c.lineTo(a+b-e,g+(d*0.25));c.moveTo(a+(b*0.505),g+(b*0.3));c.arc(a+(b*0.3),g+(b*0.3),(b*0.3)-e,deg2rad(0),deg2rad(360),false);c.moveTo(a+(b*0.905),g+d-(b*0.3));c.arc(a+(b*0.7),g+d-(b*0.3),(b*0.3)-e,deg2rad(0),deg2rad(360),false);break;case".":c.moveTo(a+(b*0.25),g+d-e-e);c.arc(a+(b*0.25),g+d-e-e,e,deg2rad(0),deg2rad(360),false);c.closePath();break;default:break}c.stroke()}function drawBar(s,j,h,q,n,t,r,u){var d=q/2;var o=d/2;n=Math.max(n,d);var z=Math.max(n-(2*o),0.1);var g;var e=d/8;var p=o/4;var A=o/2;h=h-p;if(canvas_noshadow<=0&&canvas_noshade<=0){s.save();g=s.createRadialGradient(j+d+o,h+n-d+p+o,0,j+d,h+n-d+p,d);g.addColorStop(0,"rgba(0,0,0,0.5)");g.addColorStop(0.7,"rgba(0,0,0,0.25)");g.addColorStop(0.9,"rgba(0,0,0,0.1)");g.addColorStop(1,"rgba(0,0,0,0)");s.fillStyle=g;s.scale(1,0.5);s.translate(e,h+n+p);if(isOp){s.fillRect(j,h+p+n-q,q,q)}else{s.arc(j+d,h+p+n-q,q,0,deg2rad(360),false);s.fill()}s.restore()}else{if(canvas_noshadow<=0&&canvas_noshade>=1){s.fillStyle="rgba(0,0,0,0.2)";s.fillRect(j+A,h+o+A+A,q,z)}}if(canvas_noshade<=0){s.beginPath();s.moveTo(j,h+o);s.lineTo(j,h+o+z);s.bezierCurveTo(j,h+n,j+q,h+n,j+q,h+o+z);s.lineTo(j+q,h+o);s.bezierCurveTo(j+q,h,j,h,j,h+o);s.closePath();s.fillStyle=t;s.fill();g=s.createLinearGradient(j,h+(n/2),j+q,h+(n/2));g.addColorStop(0,"rgba(255,255,255,0.75)");g.addColorStop(0.2,"rgba(255,255,255,0)");g.addColorStop(0.3,"rgba(0,0,0,0)");g.addColorStop(0.5,"rgba(0,0,0,0.1)");g.addColorStop(0.9,"rgba(0,0,0,0.35)");g.addColorStop(1,"rgba(0,0,0,0.3)");s.beginPath();s.moveTo(j,h+o);s.lineTo(j,h+o+z);s.bezierCurveTo(j,h+n,j+q,h+n,j+q,h+o+z);s.lineTo(j+q,h+o);s.bezierCurveTo(j+q,h,j,h,j,h+o);s.closePath();s.fillStyle=g;s.fill();s.beginPath();s.moveTo(j+q,h+o);s.bezierCurveTo(j+q,h,j,h,j,h+o);s.bezierCurveTo(j,h+(o*2),j+q,h+(o*2),j+q,h+o);s.closePath();s.fillStyle=t;s.fill();g=s.createLinearGradient(j+d-(q*0.15),h-2,j+d+(q*0.15),h+(2.1*o));g.addColorStop(0,"rgba(255,255,255,0.9)");g.addColorStop(0.5,"rgba(255,255,255,0)");g.addColorStop(0.6,"rgba(0,0,0,0)");g.addColorStop(1,"rgba(0,0,0,0.3)");s.beginPath();s.moveTo(j+q,h+o);s.bezierCurveTo(j+q,h,j,h,j,h+o);s.bezierCurveTo(j,h+(o*2),j+q,h+(o*2),j+q,h+o);s.closePath();s.fillStyle=g;s.fill();g=s.createLinearGradient(j+d-(q*0.15),h-2,j+d+(q*0.15),h+(2.1*o));g.addColorStop(0,"rgba(255,255,255,0.9)");g.addColorStop(0.5,"rgba(255,255,255,0)");g.addColorStop(0.6,"rgba(0,0,0,0)");g.addColorStop(1,"rgba(0,0,0,0.1)");s.beginPath();s.moveTo(j+q,h+o);s.bezierCurveTo(j+q,h,j,h,j,h+o);s.bezierCurveTo(j,h+(o*2),j+q,h+(o*2),j+q,h+o);s.closePath();s.strokeStyle=g;s.stroke()}else{s.fillStyle=t;s.fillRect(j,h+o+A,q,z)}s.lineCap="butt";s.lineWidth=1;s.fillStyle="rgba(255,255,255,0.5)";var v=q;var a=v/4;var b=roundTo(a*0.75,0);var f=a/80;var B;var k;if(canvas_notext<=0){if(canvas_htmltext<=0){k='"'+per+'"';if(k.indexOf(".")!=-1){B=k.length+0.5;k=parseFloat(B-2)*parseFloat(48*f);v=parseFloat(B-1)*parseFloat(48*f)}else{B=k.length;k=parseFloat(B-1)*parseFloat(48*f);v=parseFloat(B)*parseFloat(48*f)}roundedRect(s,j+(q/2)-(v/2),h,v,a,a/4);s.fill();if(canvas_imgtext<=0){strokeString(s,r+"%","rgba(48,48,48,1)",b,j+(q/2)-(k/2),h+((a-b)/2))}else{drawString(s,r+"%",f,j+(q/2)-(k/2),h+((a-b)/2.2))}}else{var a=v/3;var b=roundTo(a*0.75,0);roundedRect(s,j,h,v,a,a/4);s.fill();var m=document.createElement("div");m.style.position="absolute";m.style.overflow="hidden";m.style.textAlign="center";m.style.width=v+"px";m.style.left=j+"px";m.style.top=h+((a-b)/2.2)+"px";m.appendChild(document.createTextNode(per+"%"));u.appendChild(m)}}}function drawLine(n,j,h,b,k,f,e,g,c,m){if(m<=0){var a=hex2rgb(c,0.5);n.lineJoin="miter";n.beginPath();n.moveTo(j,h+k);for(var d=0;d<e.length;d++){n.lineTo(j+(d*f),h+k-(e[d]*g))}n.lineTo(j+b,h+k);n.lineTo(j,h+k);n.closePath();n.fillStyle=a;n.fill()}n.lineJoin="round";n.beginPath();n.moveTo(j,h+k-(e[0]*g));for(var d=0;d<e.length;d++){n.lineTo(j+(d*f),h+k-(e[d]*g))}n.strokeStyle=c;n.stroke()}function setDataURL(b){if(b.toDataURL){var a=document.getElementById(b.id+"_link");if(a){a.setAttribute("title","To Data URL");a.setAttribute("target","_blank");a.setAttribute("href",b.toDataURL())}}}function get_input(p,h,g){var n=document.getElementById(p);var b=document.getElementById(h);var o;var e;var f=0;var d=0;var k="";var c="";if(b.getContext){canvas_width=parseInt(b.style.width);canvas_height=parseInt(b.style.height);if(canvas_width>=16&&canvas_height>=16){var j=n.getAttribute("summary");canvas_noshade=0;canvas_noshadow=0;canvas_notext=0;canvas_imgtext=0;canvas_htmltext=0;canvas_nofill=0;if(j.search(/noshadow/)!=-1){canvas_noshadow=1}if(j.search(/noshade/)!=-1){canvas_noshade=1}if(j.search(/nofill/)!=-1){canvas_nofill=1}if(j.search(/notext/)!=-1){canvas_notext=1}if(j.search(/htmltext/)!=-1){canvas_htmltext=1}if(j.search(/imgtext/)!=-1){canvas_imgtext=1}if(n.getAttribute("bgcolor")){canvas_bgcolor=scanColor(n.getAttribute("bgcolor"))}ChartData=new Array();colorSlice=new Array();if(n.getElementsByTagName("tr")[0].getElementsByTagName("th")[0]){f=1}for(var a=f;a<n.getElementsByTagName("tr").length;a++){o=n.getElementsByTagName("tr")[a];e=o.getElementsByTagName("td").length;if(o.getElementsByTagName("td")[0].getAttribute("bgcolor")){c=scanColor(o.getElementsByTagName("td")[0].getAttribute("bgcolor"));d=0;k=trim(o.getElementsByTagName("td")[1].innerHTML.replace(/<[^>]+>/g,""));if(!g){if(e>3){for(var m=2;m<e;m++){d+=parseFloat(o.getElementsByTagName("td")[m].innerHTML.replace(/<[^>]+>/g,""))}}else{d=parseFloat(o.getElementsByTagName("td")[2].innerHTML.replace(/<[^>]+>/g,""))}if(!isNaN(d)&&d>0&&k!=""){colorSlice[a-f]=c;ChartData[k]=Math.abs(d)}else{break}}else{d=0;i=0;if(e>3&&k!=""){ChartData[a-f]=new Array();colorSlice[a-f]=c;for(var m=2;m<e;m++){d=Math.abs(parseFloat(o.getElementsByTagName("td")[m].innerHTML.replace(/<[^>]+>/g,"")));if(!isNaN(d)&&d>=0){ChartData[a-f][i]=d;i++}else{ChartData[a-f][i]=0;i++}}}else{break}}}else{break}}}}}function setPieChart(D,m){var C=(Math.min(canvas_width,canvas_height)/110)*100;var z=C*0.1;var y=C/2;var o=y*0.93;var v=C+z;var B=v;var u=(C/2)+(z/2);var t=u;var x=0;for(var M in ChartData){x+=ChartData[M]}var H=x/100;var k=document.getElementById(D);if(canvas_htmltext>=1){if(document.getElementById(m)){k.parentNode.removeChild(k.parentNode.lastChild)}}if(k.getContext){var s=k.getContext("2d");if(canvas_bgcolor!=""){s.fillStyle=canvas_bgcolor;s.fillRect(0,0,v,B)}else{s.clearRect(0,0,v,B)}if(canvas_noshadow<=0){if(!isOp){s.beginPath();var q=s.createRadialGradient(u+(y*0.1),t+(y*0.1),y,u+(y*0.1),t+(y*0.1),o*0.9);q.addColorStop(0,"rgba(0,0,0,0)");q.addColorStop(1,"rgba(0,0,0,0.5)");s.arc(u+(y*0.1),t+(y*0.1),y,0,deg2rad(360),false);s.closePath();s.fillStyle=q;s.fill()}else{var q=s.createRadialGradient(u+(y*0.1),t+(y*0.1),0,u+(y*0.1),t+(y*0.1),y);q.addColorStop(0,"rgba(0,0,0,0.5)");q.addColorStop(0.87,"rgba(0,0,0,0.5)");q.addColorStop(1,"rgba(0,0,0,0)");s.fillStyle=q;s.fillRect(0,0,v,B)}}var A=0;var r=0;var N=0;var M;for(M in ChartData){A=ChartData[M];sdeg=r;r+=(A/x)*deg2rad(360);edeg=r;s.beginPath();s.moveTo(u,t);s.arc(u,t,y,sdeg,edeg,false);s.lineTo(u,t);s.closePath();s.fillStyle=colorSlice[(N++)];s.fill()}if(canvas_noshade<=0){s.beginPath();var E=s.createLinearGradient(z*2,z*2,u,t);E.addColorStop(0,"rgba(255,255,255,0.8)");E.addColorStop(1,"rgba(255,255,255,0)");s.moveTo(u,t);s.arc(u,t,o,deg2rad(135),deg2rad(315),false);s.closePath();s.fillStyle=E;s.fill();s.beginPath();var n=s.createLinearGradient(u,t,v-(z*2),B-(z*2));n.addColorStop(0,"rgba(0,0,0,0)");n.addColorStop(1,"rgba(0,0,0,0.5)");s.moveTo(u,t);s.arc(u,t,o,deg2rad(-45),deg2rad(135),false);s.closePath();s.fillStyle=n;s.fill();s.beginPath();var j=s.createLinearGradient(u,t,v-(z*1.9),B-(z*1.9));j.addColorStop(0,"rgba(0,0,0,0)");j.addColorStop(1,"rgba(0,0,0,0.6)");s.lineWidth=y*0.07;s.lineCap="round";s.moveTo(u,t);s.arc(u,t,y*0.965,deg2rad(-45),deg2rad(135),false);s.closePath();s.strokeStyle=j;s.stroke();s.beginPath();var a=s.createLinearGradient(u,t,(z*1.9),(z*1.9));a.addColorStop(0,"rgba(255,255,255,0)");a.addColorStop(1,"rgba(255,255,255,0.6)");s.lineWidth=y*0.07;s.lineCap="round";s.moveTo(u,t);s.arc(u,t,y*0.965,deg2rad(135),deg2rad(315),false);s.closePath();s.strokeStyle=a;s.stroke()}s.lineCap="butt";s.lineWidth=1;s.fillStyle="rgba(255,255,255,0.5)";var p=0;var I=0;var h=0;var g=0;var K=0;var J=0;var b="";var F=0;var O=0;var G=y*0.45;var L=y*0.125;var d=roundTo(L*0.75,0);var e=L/80;if(canvas_notext<=0){if(canvas_htmltext>=1){G=(y*0.365);k.parentNode.style.position="relative";if(!document.getElementById(m)){b=document.createElement("div");b.id=m;b.style.color="rgb(0,0,0)";b.style.fontFamily="Arial,sans-serif";b.style.fontSize=d+"px";b.style.zIndex=11;k.parentNode.appendChild(b)}var f=document.getElementById(b.id)}for(M in ChartData){A=ChartData[M];sdeg=r;p=r+(((A/2)/x)*deg2rad(360));r+=(A/x)*deg2rad(360);edeg=r;I=roundTo(A/H,2);h=circle_point_x(p,C);g=circle_point_y(p,C);K=parseFloat((u+(2*Math.floor(u+h)))/3);J=(t+(2*Math.floor(t+g)))/3;if(canvas_htmltext<=0){F='"'+I+'"';if(F.indexOf(".")!=-1){O=F.length+0.5;F=parseFloat(O-2)*parseFloat(48*e);G=parseFloat(O-1)*parseFloat(48*e)}else{O=F.length;F=parseFloat(O-1)*parseFloat(48*e);G=parseFloat(O)*parseFloat(48*e)}roundedRect(s,(K-(G/2)),J-(L/2),G,L,L/4);s.fill();if(canvas_imgtext>=1){drawString(s,I+"%",e,K-(F/2),J-(d/1.8))}else{strokeString(s,I+"%","rgba(48,48,48,1)",d,K-(F/2),J-(d/2))}}else{roundedRect(s,(K-(G/2)),J-(L/2),G,L,L/4);s.fill();b=document.createElement("div");b.style.position="absolute";b.style.overflow="hidden";b.style.textAlign="center";b.style.width=G+"px";b.style.left=(K-(G/2))+"px";b.style.top=J-(d/1.8)+"px";b.appendChild(document.createTextNode(I+"%"));f.appendChild(b)}}}}}function setBarChart(h,r){var c=canvas_width*0.9;var m=canvas_height*0.9;var p=canvas_width*0.05;var x=canvas_height*0.05;var g=0;var d=0;for(var y in ChartData){g=Math.max(g,ChartData[y]);d+=ChartData[y]}var e=m/g;var w=colorSlice.length;var v=c/(w*1.1);var q=d/100;var f=roundTo((v/3)*0.75,0);var b=document.getElementById(h);if(b.getContext){var s=b.getContext("2d");if(canvas_bgcolor!=""){s.fillStyle=canvas_bgcolor;s.fillRect(0,0,canvas_width,canvas_height)}else{s.clearRect(0,0,canvas_width,canvas_height)}if(canvas_htmltext>=1){if(document.getElementById(r)){b.parentNode.removeChild(b.parentNode.lastChild)}b.parentNode.style.position="relative";if(!document.getElementById(r)){var j=document.createElement("div");j.id=r;j.style.color="rgb(0,0,0)";j.style.fontFamily="Arial,sans-serif";j.style.fontSize=f+"px";j.style.zIndex=11;b.parentNode.appendChild(j)}var u=document.getElementById(j.id)}var o="";var a=0;var n=0;var k=0;per=0;for(var y in ChartData){per=roundTo(ChartData[y]/q,2);a=ChartData[y]*e;drawBar(s,p+(k*(v*1.1)),x+m-a,v,a,colorSlice[(n++)],per,u);k++}}}function setLineChart(f,p){var c=canvas_width*0.9;var k=canvas_height*0.9;var o=canvas_width*0.05;var y=canvas_height*0.05;var e=0;for(var v=0;v<ChartData.length;v++){for(var s=0;s<ChartData[v].length;s++){e=Math.max(e,ChartData[v][s])}}var d=(k*0.95)/e;var w=c;var g=c/(ChartData[0].length-1);var x=k/(ChartData[0].length-1);var q=Math.min(o,y);lw=q/4;var u;var b=document.getElementById(f);if(b.getContext){var r=b.getContext("2d");if(canvas_bgcolor!=""){r.fillStyle=canvas_bgcolor;r.fillRect(0,0,canvas_width,canvas_height)}else{r.clearRect(0,0,canvas_width,canvas_height)}if(canvas_noshadow<=0){u=r.createLinearGradient(o+q,y+k+1,o+q+q,y+k+1);u.addColorStop(0,"rgba(0,0,0,0.0)");u.addColorStop(1,"rgba(0,0,0,0.5)");r.fillStyle=u;r.beginPath();r.moveTo(o+q,y+k);r.lineTo(o+q,y+k+q);r.lineTo(o+q+q,y+k);r.closePath();r.fill();u=r.createLinearGradient(o+q+q,y+k,o+q+q,y+k+q);u.addColorStop(0,"rgba(0,0,0,0.5)");u.addColorStop(1,"rgba(0,0,0,0.0)");r.fillStyle=u;r.beginPath();r.moveTo(o+q+q,y+k);r.lineTo(o+c,y+k);r.lineTo(o+q+c,y+k+q);r.lineTo(o+q,y+k+q);r.closePath();r.fill();var u=r.createLinearGradient(o+c+1,y+q,o+c+1,y+q+q);u.addColorStop(0,"rgba(0,0,0,0.0)");u.addColorStop(1,"rgba(0,0,0,0.35)");r.fillStyle=u;r.beginPath();r.moveTo(o+c,y+q);r.lineTo(o+c,y+q+q);r.lineTo(o+c+q,y+q);r.closePath();r.fill();u=r.createLinearGradient(o+c,y+q+q,o+c+q,y+q+q);u.addColorStop(0,"rgba(0,0,0,0.35)");u.addColorStop(1,"rgba(0,0,0,0.0)");r.fillStyle=u;r.beginPath();r.moveTo(o+c,y+q+q);r.lineTo(o+c,y+k);r.lineTo(o+c+q,y+k+q);r.lineTo(o+c+q,y+q);r.closePath();r.fill()}r.lineCap="butt";r.lineWidth=lw/2;r.strokeStyle="rgba(255,255,255,0.25)";if(canvas_nofill<=0){r.fillStyle="rgba(240,240,240,0.8)";r.strokeStyle="rgba(255,255,255,1)";r.fillRect(o,y,c,k)}for(var v=0;v<ChartData[0].length-1;v++){r.beginPath();r.moveTo(o+(v*g),y);r.lineTo(o+(v*g),y+k);r.stroke()}for(var v=1;v<ChartData[0].length;v++){r.beginPath();r.moveTo(o,y+(v*x));r.lineTo(o+c,y+(v*x));r.stroke()}r.lineWidth=lw;var n="";var a=0;var m=0;var h=0;for(var v=0;v<ChartData.length;v++){for(var s=0;s<ChartData[v].length;s++){h=Math.max(h,ChartData[v][s])}a=h*d;n=colorSlice[(m++)];drawLine(r,o,y+k-a,w,a,g,ChartData[v],d,n,canvas_nofill)}r.beginPath();r.moveTo(o,y);r.lineTo(o,y+k);r.lineTo(o+c+(lw/2),y+k);r.strokeStyle="rgba(48,48,48,1)";r.stroke();r.lineWidth=lw/2;u=r.createLinearGradient(o,y+k,o,y+k+q);u.addColorStop(0,"rgba(0,0,0,1)");u.addColorStop(0.5,"rgba(0,0,0,1)");u.addColorStop(1,"rgba(0,0,0,0)");r.strokeStyle=u;for(var v=0;v<ChartData[0].length;v++){r.beginPath();r.moveTo(o+(v*g),y+k);r.lineTo(o+(v*g),y+k+q);r.stroke()}u=r.createLinearGradient(o-q,y,o,y);u.addColorStop(0,"rgba(0,0,0,0)");u.addColorStop(0.5,"rgba(0,0,0,1)");u.addColorStop(1,"rgba(0,0,0,1)");r.strokeStyle=u;for(var v=1;v<ChartData[0].length;v++){r.beginPath();r.moveTo(o-q,y+(v*x));r.lineTo(o,y+(v*x));r.stroke()}}}function generateCanvas(){if(canvasSupport){var e;var g;var f;var c;var d;var b;var a;for(b=0;b<piecharts.length;b++){c=piecharts[b].id.split("_");g=piecharts[b].id;e=c[0]+"_canvas";f=c[0]+"_text";if(document.getElementById(g)){get_input(g,e);if(colorSlice.length>0){a=0;d="";for(d in ChartData){a++}if(a>0&&a==colorSlice.length){setPieChart(e,f)}}}}for(b=0;b<barcharts.length;b++){c=barcharts[b].id.split("_");g=barcharts[b].id;e=c[0]+"_canvas";f=c[0]+"_text";if(document.getElementById(g)){get_input(g,e);if(colorSlice.length>0){a=0;d="";for(d in ChartData){a++}if(a>0&&a==colorSlice.length){setBarChart(e,f)}}}}for(b=0;b<linecharts.length;b++){c=linecharts[b].id.split("_");g=linecharts[b].id;e=c[0]+"_canvas";f=c[0]+"_text";if(document.getElementById(g)){get_input(g,e,true);if(colorSlice.length>0){if(ChartData.length==colorSlice.length){setLineChart(e,f)}}}}}}function setListPos(e){if(!isIE){var f=document.getElementById("list");var a=findPosX(f);var h=findPosY(f);var g=document.getElementById("jumplist");g.style.position="fixed";g.style.left=a+"px";g.style.top=h+"px";var d=document.getElementById("volumelist");f=document.getElementById("volume");a=findPosX(f);if(isOp){h=window.innerHeight-imgHeight}else{h=findPosY(f)}d.style.position="fixed";d.style.left=a+"px";d.style.top=h+"px";var b=document.getElementById("delaylist");f=document.getElementById("delay");a=findPosX(f);if(isOp){h=window.innerHeight-imgHeight}else{h=findPosY(f)}b.style.position="fixed";b.style.left=a+"px";b.style.top=h+"px";var c=document.getElementById("navLinks")}if(e){if(isIE){}else{g.style.opacity=0;d.style.opacity=0;b.style.opacity=0;c.style.opacity=0.8}}}function switchFade(){if(tranSitions&&s5mode&&fadeModus){fadeModus=false;playDelay=playDelay-(2*fadeDuration);var a=document.getElementById("fade");changeClass(a,"isoff")}else{if(tranSitions&&s5mode&&!fadeModus){fadeModus=true;playDelay=playDelay+(2*fadeDuration);var a=document.getElementById("fade");changeClass(a,"ison")}}currentSlide()}function opacity(d,f,a,c){var e=Math.round(c/100);var g=0;if(f>a){for(var b=f;b>=a;b--){window.setTimeout("changeOpac("+b+",'"+d+"')",(g*e));g++}}else{if(f<a){for(var b=f;b<=a;b++){window.setTimeout("changeOpac("+b+",'"+d+"')",(g*e));g++}}}}function changeOpac(a,b){var c=document.getElementById(b);if(isIE){c.style.filter="alpha(opacity="+a+")"}else{c.style.opacity=(a/100)}}function shiftOpacity(c,b){if(document.getElementById(c).style.opacity!=""){var a=document.getElementById(c).style.opacity*100}else{var a=0}if(a==0){opacity(c,a,100,b)}else{if(a>0){opacity(c,a,0,b)}}}function autoPlay(){if(s5mode&&autoMatic&&!playPause){if((snum>=(smax-1))&&playLoop){goTo(0);autoRun=setTimeout("autoPlay();",playDelay)}else{if((snum>=(smax-1))&&!playLoop){stopPlay()}else{if(!incrementals[snum]||incpos>=incrementals[snum].length){go(1);if(incrementals[snum].length>0){clearTimeout(autoRun);autoRun=null;incrDelay=parseInt(playDelay/(incrementals[snum].length+1));remainDer=parseInt(playDelay-(incrDelay*incrementals[snum].length));autoRun=setTimeout("autoPlayIncr()",incrDelay)}}else{clearTimeout(autoRun);autoRun=null;incrDelay=incrDuration;remainDer=parseInt(playDelay-(incrementals[snum].length*incrDuration));autoRun=setTimeout("autoPlayIncr()",incrDelay)}autoRun=setTimeout("autoPlay();",playDelay)}}}}function autoPlayIncr(){if(incpos<incrementals[snum].length){subgo(1);autoRun=setTimeout("autoPlayIncr();",incrDelay)}else{autoRun=setTimeout("nop();",remainDer)}}function nop(){}function togglePlay(){if(autoRun&&s5mode){stopPlay()}else{if(!autoRun&&s5mode){startPlay()}}}function stopPlay(){if(autoRun&&s5mode){clearTimeout(autoRun);autoRun=null;autoMatic=false;playPause=false;var a="";a=document.getElementById("auto");changeClass(a,"isoff");a=document.getElementById("pause");changeClass(a,"isoff");currentSlide()}}function startPlay(){if(!autoRun&&s5mode){playPause=false;autoMatic=true;var a="";a=document.getElementById("auto");changeClass(a,"ison");a=document.getElementById("pause");changeClass(a,"isoff");autoRun=setTimeout("autoPlay();",playDelay);currentSlide()}}function pausePlay(){if(s5mode&&autoMatic){if(playPause){playPause=false;autoRun=setTimeout("autoPlay();",playDelay);var a=document.getElementById("pause");changeClass(a,"isoff")}else{if(autoRun){clearTimeout(autoRun);autoRun=null;playPause=true;var a=document.getElementById("pause");changeClass(a,"ison")}}currentSlide()}}function switchLoop(){if(s5mode){if(playLoop){playLoop=false;var a=document.getElementById("loop");changeClass(a,"isoff")}else{playLoop=true;var a=document.getElementById("loop");changeClass(a,"ison")}}currentSlide()}function setDelay(){var b=document.getElementById("delaylist");if(s5mode){var a=Math.max(5,Math.min(parseInt(b.value),300));playDelay=(fadeModus==true)?((a*1000)+(2*fadeDuration)):(a*1000)}}function createSoundManagerScript(){if(typeof soundManager=="undefined"){onerrorSM2()}else{var b=document.createElement("SCRIPT");var a=document.createTextNode("soundManager.createMovie();");b.appendChild(a);document.getElementsByTagName("body")[0].appendChild(b)}}function onloadSM2(){if(!isIE){swfUnloaded=false;preloadSounds()}}function onerrorSM2(){if(typeof soundManager!="undefined"){soundManager.destruct;delete soundManager}audioSupport=false;swfUnloaded=true;if(audioError&&!isIE&&!isOp){var b=document.createElement("div");b.id="guru";var c=document.createElement("div");b.appendChild(c);var a=document.createTextNode("Guru Meditation - SoundManager failed to load/initialize!");c.appendChild(a);document.getElementById("slide0").appendChild(b)}}function audioSetup(){if(sound[0]){playSound(0)}else{if(sound[bgSoundItem]&&!sound[0]){playSound(bgSoundItem)}}}function fadeoutSound(f,e){if(curSoundID>=0&&!swfUnloaded){if(isNaN(f)){if(f=="bgSound"){var a=parseInt(bgSoundItem)}else{for(var d=0;d<(sound.length-1);d++){if(sound[d]&&f==sound[d]["id"]){var a=d;break}}}}else{var a=f;f=sound[a]["id"]}var c=getMaxVolume(sound[a]["volume"]);var b=fadeDuration;var g=Math.round(b/c);var h=0;for(var d=c;d>0;d--){setTimeout("fadeout("+d+",'"+f+"')",(h*g));h++}if(e){setTimeout("stopSound('"+f+"')",b)}}}function fadeout(a,b){soundManager.setVolume(b,a)}function stopSound(b){var a;if(isNaN(b)){a=b}else{if(sound[b]){a=sound[b]["id"]}}if(a!=""&&curSoundID>=0){soundManager.stop(a);curSoundID=-1}}function toggleSounds(){if(audioSupport&&!swfUnloaded){stopAllSounds()}else{if(!audioSupport&&!swfUnloaded){allowSounds()}}}function allowSounds(){if(!swfUnloaded){audioSupport=true;var a=document.getElementById("audio");changeClass(a,"ison");currentSlide()}}function stopAllSounds(){if(curSoundID>=0){stopSound(curSoundID)}else{soundManager.stopAll();curSoundID=-1}audioSupport=false;var a=document.getElementById("audio");changeClass(a,"isoff");currentSlide()}function playSound(f){if(audioSupport&&!swfUnloaded){var c,a,d,e,b;if(isNaN(f)){a=f;if(a=="bgSound"){b=parseInt(bgSoundItem)}else{b=getSoundID(f)}}else{b=parseInt(f);if(sound[b]){a=sound[b]["id"]}}if(sound[b]&&sound[b]["url"]!=""&&a!=""){c=sound[b]["url"];d=(sound[b]["volume"]!="")?getMaxVolume(sound[b]["volume"]):getMaxVolume(100);e=(sound[b]["loops"])?true:false;if(e){soundManager.play(a,{volume:d,onplay:function(){curSoundID=b},onfinish:function(){soundManager.play(a,{volume:getMaxVolume(sound[b]["volume"])})}})}else{soundManager.play(a,{volume:d,onplay:function(){curSoundID=b},onfinish:function(){curSoundID=-1}})}}}}function getSoundID(b){for(var a=0;a<(sound.length-1);a++){if(sound[a]&&b==sound[a]["id"]){var c=a;break}}return c}function setVolume(){var c=document.getElementById("volumelist");if(audioSupport&&!swfUnloaded){audioVolume=parseInt(c.value);if(curSoundID>=0){if(sound[curSoundID]){var b=sound[curSoundID]["id"];var a=getMaxVolume(sound[curSoundID]["volume"]);soundManager.setVolume(b,a)}}}}function getMaxVolume(b){if(audioVolume>0){var a=audioVolume/100}else{var a=0}return Math.max(0,Math.min(parseInt(b*a),audioVolume))}function preloadSounds(){var b="";var h="";var f="";var a="";var g=document.getElementsByTagName("object");for(var e=0;e<g.length;e++){if(g[e].type.toLowerCase()=="audio/mp3"&&g[e].data!=""){g[e].width=0;g[e].height=0;if(g[e].parentNode.tagName=="DIV"){a=g[e].parentNode.className.toLowerCase();if(a=="presentation"||a=="slide"){if(a=="presentation"){f=parseInt(bgSoundItem)}else{f=parseInt(g[e].parentNode.id.slice(5,g[e].parentNode.id.length))}sound[f]=new Object();if(f<bgSoundItem){sound[f]["id"]=g[e].parentNode.id}else{sound[f]["id"]="bgSound"}sound[f]["url"]=g[e].data;sound[f]["volume"]=100;sound[f]["loops"]=false;if(g[e].archive!=""){h=g[e].archive.toLowerCase().split(",");for(var c=0;c<h.length;c++){if(h[c]=="loop"){sound[f]["loops"]=true}if(h[c].search(/^volume/)!=-1){var d=h[c].split(":");sound[f]["volume"]=parseInt(d[1])}}}soundManager.createSound(sound[f]["id"],sound[f]["url"])}}}}}function createHelpReq(){if(!document.getElementById("HelpReq")){var a=document.getElementsByTagName("body")[0].firstChild;var b=document.createElement("div");b.id="HelpReq";if(b.addEventListener){b.addEventListener("onclick",dumpHelpReq,false)}else{if(b.attachEvent){b.attachEvent("onclick",dumpHelpReq)}}b.style.position="absolute";b.style.left=0+"px";b.style.top=0+"px";b.style.width=100+"%";b.style.height=100+"%";b.style.margin=0+"px";b.style.padding=0+"px";if(isIE){b.style.filter="alpha(opacity=90)"}else{b.style.opacity=0.9}b.style.zIndex=9999;b.style.backgroundColor="rgb(64,64,64)";b.style.textAlign="center";b.style.verticalAlign="middle";b.style.backgroundPosition="center center";b.style.backgroundRepeat="no-repeat";b.style.backgroundImage="url("+imagePath+"help.jpg)";document.getElementsByTagName("body")[0].insertBefore(b,a);if(document.getElementById("HelpReq")){helpmode=true}}}function dumpHelpReq(){if(document.getElementById("HelpReq")){document.body.removeChild(document.getElementById("HelpReq"));helpmode=false}}function ConsoleLog(a){if(window.console){window.console.log(a)}}function soundManagerLoaded(){var a=document.getElementsByTagName("meta");for(var c=0;c<a.length;c++){if(a[c].name=="audioDebug"){var b=(a[c].content=="true")?true:false;soundManager.debugMode=b}}}if(!isIE&&!isOp){var script=document.createElement("script");script.setAttribute("type","text/javascript");script.setAttribute("src",commonPath+"audio/soundmanager2.js");script.onreadystatechange=function(){if(this.readyState=="complete"){soundManagerLoaded()}};script.onload=soundManagerLoaded;document.getElementsByTagName("head")[0].appendChild(script)}window.onload=createSlideShow;window.onresize=function(){setTimeout("windowChange()",5)};