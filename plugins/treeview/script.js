(function(b){b.fn.treeView=function(a){function s(c,e){if(a.stateStore){var d=jStorage.get(a.stateStore,[]);if(e)b.inArray(c,d)<0&&d.push(c);else d=b.grep(d,function(f){return f!=c});jStorage.set(a.stateStore,d)}}function m(c){var e=c[3],d=b('<li><div class="'+(c[1]?"hitarea collapsed":"placeholder")+'"><div class="arrow"/><div class="'+c[2]+'"/></div><a href="'+e+'">'+c[4]+"</a></li>"),f=d.children(".hitarea");d.data("name",c[4]).data("tree",c[0]?1:0);f.click(function(){if(f.hasClass("collapsed")){n(d,
e);f.removeClass("collapsed").addClass("expanded")}else{d.children("ul").hide();f.removeClass("expanded").addClass("collapsed")}s(e,f.hasClass("expanded"));return false});if(a.stateStore&&b.inArray(e,jStorage.get(a.stateStore,[]))>=0){n(d,e);f.removeClass("collapsed").addClass("expanded")}return d}function n(c,e){function d(i){var j=b("<ul/>");b.each(i,function(o,k){j.append(m(k))});e==a.root&&c.empty();c.children("ul").remove();c.removeClass("wait").append(j)}function f(i){h&&jStorage.set(h,i);var j=
{},o=[];b.each(i,function(k,g){j[g[4]]=g});b("> ul > li",c).each(function(){var k=b(this),g=k.data("name");if(j[g])delete j[g];else k.remove();o.push(b(this))});b.each(j,function(k,g){var p=false;b.each(o,function(t,l){if(g[0]&&!l.data("tree")||k<l.data("name")&&g[0]==l.data("tree")){p=true;l.before(m(g));return false}});p||c.children("ul").append(m(g))})}function q(){setTimeout(function(){b.ajax({url:a.url,data:{dir:e},success:f,error:function(){h&&jStorage.remove(h)}})},a.delay)}var h=a.cacheStore?
a.cacheStore+":"+e:null;if(c.children("ul").length!=0){c.children("ul").show();q()}else{c.addClass("wait");var r=h?jStorage.get(h):null;if(r){d(r);q()}else b.getJSON(a.url,{dir:e},function(i){d(i);h&&jStorage.set(h,i)})}}a||(a={});if(!a.root)a.root="/";if(!a.url)a.url="/_/treeview.json";if(!a.delay)a.delay=2E3;this.each(function(){n(b(this),a.root)})}})(jQuery);$.translations({en:{menu:"Menu",tree:"Tree"},de:{menu:"Men\u00fc",tree:"Baumansicht"}});
(function(){var b=$("#sidebar");b.html('<div id="treeview-tabs"><ul><li class="tabs-selected"><a href="#sidebar-menu">'+$.t("menu")+'</a></li><li><a href="#sidebar-treeview">'+$.t("tree")+'</a></li></ul></div><div id="sidebar-treeview"><h1>'+$.t("tree")+'</h1><div id="treeview"/></div><div id="sidebar-menu">'+b.html()+"</div>");$("#treeview-tabs").tabs({store:"treeview-tabs"});$("#treeview").treeView({stateStore:"treeview-state",cacheStore:"treeview-cache"})})();
