(function(c){c.fn.treeView=function(a){function m(b,e){if(a.stateStore){var d=jStorage.get(a.stateStore,[]);if(e)c.inArray(b,d)<0&&d.push(b);else d=c.grep(d,function(f){return f!=b});jStorage.set(a.stateStore,d)}}function n(b){var e=b[3],d=c('<li><div class="'+(b[1]?"hitarea collapsed":"placeholder")+'"><div class="arrow"/><div class="'+b[2]+'"/></div><a href="'+e+'">'+b[4]+"</a></li>"),f=d.children(".hitarea");d.data("name",b[4]).data("tree",b[0]?1:0);f.click(function(){if(f.hasClass("collapsed")){o(d,
e);f.removeClass("collapsed").addClass("expanded")}else{d.children("ul").hide();f.removeClass("expanded").addClass("collapsed")}m(e,f.hasClass("expanded"));return false});if(a.stateStore&&c.inArray(e,jStorage.get(a.stateStore,[]))>=0){o(d,e);f.removeClass("collapsed").addClass("expanded")}return d}function o(b,e){function d(i){var j=c("<ul/>");c.each(i,function(p,k){j.append(n(k))});e==a.root&&b.empty();b.children("ul").remove();b.append(j)}function f(i){h&&jStorage.set(h,i);var j={},p=[];c.each(i,
function(k,g){j[g[4]]=g});c("> ul > li",b).each(function(){var k=c(this),g=k.data("name");if(j[g])delete j[g];else k.remove();p.push(c(this))});c.each(j,function(k,g){var q=false;c.each(p,function(t,l){if(g[0]&&!l.data("tree")||k<l.data("name")&&g[0]==l.data("tree")){q=true;l.before(n(g));return false}});q||b.children("ul").append(n(g))})}function r(){setTimeout(function(){a.ajax(e,f,function(){h&&jStorage.remove(h)})},a.delay)}var h=a.cacheStore?a.cacheStore+":"+e:null;if(b.children("ul").length!=
0){b.children("ul").show();r()}else{var s=h?jStorage.get(h):null;if(s){d(s);r()}else{b.addClass("wait");a.ajax(e,function(i){b.removeClass("wait");d(i);h&&jStorage.set(h,i)},function(){b.removeClass("wait")})}}}a||(a={});if(!a.root)a.root="/";if(!a.url)a.url="/treeview.json";if(!a.delay)a.delay=2E3;if(!a.ajax)a.ajax=function(b,e,d){c.ajax({url:a.url,data:{dir:b},success:e,error:d})};this.each(function(){o(c(this),a.root)})}})(jQuery);$.translations({en:{menu:"Menu",tree:"Tree"},de:{menu:"Men\u00fc",tree:"Baumansicht"}});
(function(){$("#sidebar").wrapInner('<div id="sidebar-menu"/>').prepend('<div id="treeview-tabs"><ul><li class="selected"><a href="#sidebar-menu">'+$.t("menu")+'</a></li><li><a href="#sidebar-treeview">'+$.t("tree")+'</a></li></ul></div><div id="sidebar-treeview"><h1>'+$.t("tree")+'</h1><div id="treeview"/></div>');$("#treeview-tabs").tabs({store:"treeview-tabs"});$("#treeview").treeView({stateStore:"treeview-state",cacheStore:"treeview-cache",ajax:function(c,a,m){$.ajax({url:c,data:{output:"treeview.json"},
success:a,error:m})}})})();
